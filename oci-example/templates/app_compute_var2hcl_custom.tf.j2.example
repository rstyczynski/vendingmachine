# ═══════════════════════════════════════════════════════════════
# Custom Variable Proxy Layer: {{ app_name.upper() }} Compute Instances
# 
# This file is OPTIONAL. Copy this file to {{ app_name }}_compute_var2hcl_custom.tf
# and customize the var2hcl transformation logic as needed.
#
# When this file exists and defines {{ app_name }}_compute_instances_var2hcl_custom_override,
# it will override the default var2hcl logic from {{ app_name }}_compute_var2hcl.tf
# ═══════════════════════════════════════════════════════════════

locals {
  # Custom proxy layer: Transform {{ app_name.upper() }} compute instance variables into locals
  # This will override the default var2hcl logic from {{ app_name }}_compute_var2hcl.tf
  # 
  # Add your custom transformation logic here:
  # - Transform values (e.g., normalize, uppercase, add defaults)
  # - Add computed fields
  # - Apply business logic rules
  # - Merge with additional data sources
  {{ app_name }}_compute_instances_var2hcl_custom_override = {
    for k, v in var.{{ app_name }}_compute_instances : k => {
      instance_fqrn = k
      zone          = local.zones_var2hcl[v.zone].subnet
      availability_domain = local.zones_var2hcl[v.zone].ad
      nsg          = v.nsg
      spec         = merge(v.spec, {
        # Example: Add custom transformations
        # enable_bastion_plugin = true  # Force enable bastion plugin for all instances
        # shape = "VM.Standard.E4.Flex"  # Override shape for all instances
      })
    }
  }
}

